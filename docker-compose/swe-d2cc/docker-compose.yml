version: "3.7"
services:
  swe-d2cc-app:
    image: farao/gridcapa-app:latest
    volumes:
      - ../common/config/env.json:/usr/local/apache2/htdocs/gridcapa/env.json:Z
      - ./config/swe-d2cc-process-metadata.json:/usr/local/apache2/htdocs/gridcapa/process-metadata.json:Z
    networks:
      - gridcapa

  swe-d2cc-cgm-coreso-sv-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-coreso-sv-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-cgm-ree-eq-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-ree-eq-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-cgm-ree-ssh-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-ree-ssh-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa


  swe-d2cc-cgm-ren-tp-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-ren-tp-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-cgm-ren-eq-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-ren-eq-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-cgm-ren-ssh-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-ren-ssh-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-cgm-rte-tp-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-rte-tp-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-cgm-rte-eq-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-rte-eq-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-cgm-rte-ssh-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-rte-ssh-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-cgm-ree-tp-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-cgm-ree-tp-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-crac-data-bridge:
    image: farao/gridcapa-data-bridge:latest
    volumes:
      - ./config/data-bridge/swe-d2cc-crac-data-bridge-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-task-manager:
    image: farao/gridcapa-task-manager:latest
    volumes:
      - ./config/swe-d2cc-task-manager-application.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-job-launcher:
    image: farao/gridcapa-job-launcher:latest
    volumes:
      - ./config/swe-d2cc-job-launcher.yml:/config/application.yml
    networks:
      - gridcapa

  swe-d2cc-adapter:
    image: farao/gridcapa-swe-adapter:LOCAL
    volumes:
      - ./config/swe-d2cc-adapter-application.yml:/config/application.yml
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8080/actuator/health" ]
      interval: 30s
      timeout: 30s
      retries: 5
    networks:
      - gridcapa

  swe-d2cc-runner:
    image: farao/gridcapa-swe-runner:LOCAL
    volumes:
      - ./config/swe-d2cc-runner-application.yml:/config/application.yml
#      - ./config/core-valid-itools-config-OLF.yml:/home/farao/.itools/config.yml
      - ./config/20220801_0230_rr1_UX1_EQX.xml:/home/farao/.itools/cgmes/boundary/20220801_0230_rr1_UX1_EQX.xml
      - ./config/20220801_0230_rr1_UX1_TPX.xml:/home/farao/.itools/cgmes/boundary/20220801_0230_rr1_UX1_TPX.xml
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8080/actuator/health" ]
      interval: 30s
      timeout: 30s
      retries: 5
    networks:
      - gridcapa

networks:
  gridcapa:
    name: gridcapa
