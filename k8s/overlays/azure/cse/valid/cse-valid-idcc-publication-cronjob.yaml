kind: CronJob
apiVersion: batch/v1
metadata:
  name: cse-valid-idcc-publication-cronjob
  labels:
    app: gridcapa
    component: cse-valid-idcc-publication-cronjob
    region: cse
    process: valid-idcc
spec:
  schedule: "5 1 * * *"
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 3
  successfulJobsHistoryLimit: 3
  jobTemplate:
    spec:
      template:
        spec:
          containers:
            - name: cse-valid-idcc-publication-cronjob
              image: centos
              args:
                - /bin/sh
                - -c
                - curl -X POST -d "process=IDCC&targetDate=$(date --iso-8601)" http://gridcapa-dev.farao-community.com/cse/valid/idcc/publication/publish
          restartPolicy: OnFailure