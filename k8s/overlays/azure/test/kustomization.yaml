apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
  - ../../../cse/idcc
  - ../common
  - ../core/valid

resources:
  - apps-metadata-server-configmap.yaml
  - gridcapa-app-env-configmap.yaml
  - gridcapa-ingress.yaml

configMapGenerator:
  - name: env-configmap
    env: env.properties

patches:
  - patch: |-
      kind: Deployment
      apiVersion: apps/v1
      metadata:
        name: cse-idcc-rao-runner
      spec:
        template:
          spec:
            containers:
              - name: cse-idcc-rao-runner
                resources:
                  requests:
                    cpu: "14.0"
                    memory: "20Gi"
                  limits:
                    cpu: "16.0"
                    memory: "50Gi"

images:
  - name: gridcapa-task-notification-server
    newName: docker.io/springcloudstream/websocket-sink-rabbit
    newTag: 2021.0.x
  - name: apps-metadata-server
    newName: bitnami/apache
    newTag: "2.4"
  - name: rabbitmq
    newName: docker.io/rabbitmq
    newTag: management
  - name: minio
    newName: docker.io/bitnami/minio
    newTag: 2021.6.17
  - name: gridsuite-config-notification-server
    newName: docker.io/gridsuite/config-notification-server
    newTag: 0.0.1
  - name: gridsuite-config-server
    newName: docker.io/gridsuite/config-server
    newTag: 0.0.1
  - name: gridcapa-app
    newName: docker.io/farao/gridcapa-app
    newTag: v1.0.0
  - name: gridcapa-cse-input-data-bridge
    newName: docker.io/farao/gridcapa-data-bridge
    newTag: v1.0.0
  - name: gridcapa-cse-adapter
    newName: docker.io/farao/gridcapa-cse-adapter
    newTag: v1.0.0
  - name: gridcapa-cse-job-launcher
    newName: docker.io/farao/gridcapa-job-launcher
    newTag: v1.0.0
  - name: gridcapa-cse-rao-logs-dispatcher
    newName: docker.io/farao/gridcapa-rao-logs-dispatcher
    newTag: v1.0.0
  - name: gridcapa-cse-rao-runner
    newName: docker.io/farao/gridcapa-rao-runner
    newTag: v1.0.0
  - name: gridcapa-cse-runner
    newName: docker.io/farao/gridcapa-cse-runner
    newTag: v1.0.0
  - name: gridcapa-cse-task-manager
    newName: docker.io/farao/gridcapa-task-manager
    newTag: v1.0.0
  - name: gridcapa-core-valid-input-data-bridge
    newName: docker.io/farao/gridcapa-data-bridge
    newTag: v1.0.0
  - name: gridcapa-core-valid-output-data-bridge
    newName: docker.io/farao/gridcapa-output-data-bridge
    newTag: v1.0.0
  - name: gridcapa-core-valid-adapter
    newName: docker.io/farao/gridcapa-core-valid-adapter
    newTag: v1.0.0
  - name: gridcapa-core-valid-job-launcher
    newName: docker.io/farao/gridcapa-job-launcher
    newTag: v1.0.0
  - name: gridcapa-core-valid-rao-logs-dispatcher
    newName: docker.io/farao/gridcapa-rao-logs-dispatcher
    newTag: v1.0.0
  - name: gridcapa-core-valid-rao-runner
    newName: docker.io/farao/gridcapa-rao-runner
    newTag: v1.0.0
  - name: gridcapa-core-valid-runner
    newName: docker.io/farao/gridcapa-core-valid
    newTag: v1.0.0
  - name: gridcapa-core-valid-task-manager
    newName: docker.io/farao/gridcapa-task-manager
    newTag: v1.0.0